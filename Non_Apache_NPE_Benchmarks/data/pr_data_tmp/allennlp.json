[
    {
        "pr": "https://github.com/allenai/allennlp/pull/4917",
        "repo": "allennlp",
        "number": 4917,
        "bug_id": "allennlp_4917",
        "title": "Generic Callbacks",
        "body": "This is a draft for generic callbacks to handle multiple types of events.\r\nThe volume of code changed is big, so I fully understand you not rushing to merge this into master.\r\nHowever, this change introduces several breaking changes that may be best to have for v2.0 (discussed at #4826).\r\n\r\n\r\n- Removed `EpochCallback`, `BatchCallback` in favour of `TrainerCallback`. The metaclass-wrapping implementation is removed as well.\r\n- The `TrainerCallack.on_epoch()` does not fire with `epoch=-1` at the start of the training. Instead, method `TrainerCallback.on_start()` should be used for these cases.\r\n- Now Trainer always fires `TrainerCallback.on_end()` so all the resources can be cleaned up properly.\r\n\r\n- The `TrainerCallback` constructor accepts `serialization_dir` provided by `Trainer`. This can be useful for `Logger` callbacks those need to store files in the run directory.\r\n- The `TrainerCallback` event methods now accept `**kwargs`. This may be useful to maintain backwards-compatibility of callbacks easier in the future. E.g. we may decide to pass the exception/traceback object in case of failure to `on_end()` and the older callbacks may simply ignore the argument instead of raising a `TypeError`.\r\n- `TensorBoardBatchMemoryUsage` is converted from `BatchCallback` into `TrainerCallback`. `TrackEpochCallback` is converted from `EpochCallback` into `TrainerCallback`.\r\n- `Trainer` can accept callbacks simply with the name `callbacks` instead of `trainer_callbacks`.\r\n- Fixed the misspelling, changed `TensoboardBatchMemoryUsage` to `TensorBoardBatchMemoryUsage`.\r\n- We set a value to `epoch` so in case of firing `TrainerCallback.on_end()` the variable is bound.\r\n  This could have lead to an error in case of trying to recover a run after it was finished training, and at least one end callback is enabled.",
        "date": "2021-01-22",
        "files": [
            {
                "sha": "b9f664595d8c5c5e6c30c9f1cee4fabcccd2cd41",
                "filename": "CHANGELOG.md",
                "status": "modified",
                "additions": 52,
                "deletions": 1,
                "changes": 53,
                "blob_url": "https://github.com/allenai/allennlp/blob/93054bcb137181b12d3d14d259c97375db20a701/CHANGELOG.md",
                "raw_url": "https://github.com/allenai/allennlp/raw/93054bcb137181b12d3d14d259c97375db20a701/CHANGELOG.md",
                "contents_url": "https://api.github.com/repos/allenai/allennlp/contents/CHANGELOG.md?ref=93054bcb137181b12d3d14d259c97375db20a701"
            },
            {
                "sha": "d14a0845f2b55dffc489f0654509a0e463953efb",
                "filename": "allennlp/training/__init__.py",
                "status": "modified",
                "additions": 1,
                "deletions": 2,
                "changes": 3,
                "blob_url": "https://github.com/allenai/allennlp/blob/93054bcb137181b12d3d14d259c97375db20a701/allennlp/training/__init__.py",
                "raw_url": "https://github.com/allenai/allennlp/raw/93054bcb137181b12d3d14d259c97375db20a701/allennlp/training/__init__.py",
                "contents_url": "https://api.github.com/repos/allenai/allennlp/contents/allennlp/training/__init__.py?ref=93054bcb137181b12d3d14d259c97375db20a701"
            },
            {
                "sha": "81d18aca8981dfffbe8d3ea6febbf8bfa7ff9049",
                "filename": "allennlp/training/trainer.py",
                "status": "modified",
                "additions": 110,
                "deletions": 199,
                "changes": 309,
                "blob_url": "https://github.com/allenai/allennlp/blob/93054bcb137181b12d3d14d259c97375db20a701/allennlp/training/trainer.py",
                "raw_url": "https://github.com/allenai/allennlp/raw/93054bcb137181b12d3d14d259c97375db20a701/allennlp/training/trainer.py",
                "contents_url": "https://api.github.com/repos/allenai/allennlp/contents/allennlp/training/trainer.py?ref=93054bcb137181b12d3d14d259c97375db20a701"
            },
            {
                "sha": "3d2910740f5880890772eaa04066d398d3572ad7",
                "filename": "tests/commands/train_test.py",
                "status": "modified",
                "additions": 21,
                "deletions": 20,
                "changes": 41,
                "blob_url": "https://github.com/allenai/allennlp/blob/93054bcb137181b12d3d14d259c97375db20a701/tests/commands/train_test.py",
                "raw_url": "https://github.com/allenai/allennlp/raw/93054bcb137181b12d3d14d259c97375db20a701/tests/commands/train_test.py",
                "contents_url": "https://api.github.com/repos/allenai/allennlp/contents/tests/commands/train_test.py?ref=93054bcb137181b12d3d14d259c97375db20a701"
            },
            {
                "sha": "fbf93461652ea2fd0d53105935b66e0091d2b0a7",
                "filename": "tests/training/trainer_test.py",
                "status": "modified",
                "additions": 32,
                "deletions": 98,
                "changes": 130,
                "blob_url": "https://github.com/allenai/allennlp/blob/93054bcb137181b12d3d14d259c97375db20a701/tests/training/trainer_test.py",
                "raw_url": "https://github.com/allenai/allennlp/raw/93054bcb137181b12d3d14d259c97375db20a701/tests/training/trainer_test.py",
                "contents_url": "https://api.github.com/repos/allenai/allennlp/contents/tests/training/trainer_test.py?ref=93054bcb137181b12d3d14d259c97375db20a701"
            }
        ]
    }
]