[
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/3897",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/3897/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/3897/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/3897/events",
        "html_url": "https://github.com/beetbox/beets/pull/3897",
        "id": 838483957,
        "node_id": "MDExOlB1bGxSZXF1ZXN0NTk4NjU4NjI2",
        "number": 3897,
        "title": "plugins: Python 3.10 compatibility",
        "user": {
            "login": "wisp3rwind",
            "id": 17089248,
            "node_id": "MDQ6VXNlcjE3MDg5MjQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/17089248?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wisp3rwind",
            "html_url": "https://github.com/wisp3rwind",
            "followers_url": "https://api.github.com/users/wisp3rwind/followers",
            "following_url": "https://api.github.com/users/wisp3rwind/following{/other_user}",
            "gists_url": "https://api.github.com/users/wisp3rwind/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wisp3rwind/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wisp3rwind/subscriptions",
            "organizations_url": "https://api.github.com/users/wisp3rwind/orgs",
            "repos_url": "https://api.github.com/users/wisp3rwind/repos",
            "events_url": "https://api.github.com/users/wisp3rwind/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wisp3rwind/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": {
            "url": "https://api.github.com/repos/beetbox/beets/milestones/17",
            "html_url": "https://github.com/beetbox/beets/milestone/17",
            "labels_url": "https://api.github.com/repos/beetbox/beets/milestones/17/labels",
            "id": 6580856,
            "node_id": "MDk6TWlsZXN0b25lNjU4MDg1Ng==",
            "number": 17,
            "title": "Python 3.10 support",
            "description": "Python 3.10 is [due for release on 2021-10-04](https://www.python.org/dev/peps/pep-0619/). We're running CI on nightly versions: https://github.com/beetbox/beets/pull/3896. Let's collect issues that need to be addressed for supporting 3.10 here.",
            "creator": {
                "login": "wisp3rwind",
                "id": 17089248,
                "node_id": "MDQ6VXNlcjE3MDg5MjQ4",
                "avatar_url": "https://avatars.githubusercontent.com/u/17089248?v=4",
                "gravatar_id": "",
                "url": "https://api.github.com/users/wisp3rwind",
                "html_url": "https://github.com/wisp3rwind",
                "followers_url": "https://api.github.com/users/wisp3rwind/followers",
                "following_url": "https://api.github.com/users/wisp3rwind/following{/other_user}",
                "gists_url": "https://api.github.com/users/wisp3rwind/gists{/gist_id}",
                "starred_url": "https://api.github.com/users/wisp3rwind/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/wisp3rwind/subscriptions",
                "organizations_url": "https://api.github.com/users/wisp3rwind/orgs",
                "repos_url": "https://api.github.com/users/wisp3rwind/repos",
                "events_url": "https://api.github.com/users/wisp3rwind/events{/privacy}",
                "received_events_url": "https://api.github.com/users/wisp3rwind/received_events",
                "type": "User",
                "site_admin": false
            },
            "open_issues": 0,
            "closed_issues": 2,
            "state": "open",
            "created_at": "2021-03-23T08:40:37Z",
            "updated_at": "2021-05-11T21:03:58Z",
            "due_on": "2021-10-04T07:00:00Z",
            "closed_at": null
        },
        "comments": 0,
        "created_at": "2021-03-23T08:36:22Z",
        "updated_at": "2021-03-24T17:49:31Z",
        "closed_at": "2021-03-24T17:49:28Z",
        "author_association": "MEMBER",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/3897",
            "html_url": "https://github.com/beetbox/beets/pull/3897",
            "diff_url": "https://github.com/beetbox/beets/pull/3897.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/3897.patch"
        },
        "body": "As https://github.com/beetbox/beets/pull/3896 uncovers, there is indeed some breakage on Python alpha. See the commit message:\r\n\r\n```\r\nIn\r\n\r\n766c8b190bb782a5ef7bafbfa657007d4f158872 from [1]\r\n\r\na slight hack was introduced that allowed to add new arguments to\r\nplugin events without breaking legacy plugins that did not feature\r\nthose arguments in the signature of their handler functions.\r\n\r\nWhen improving logging management for plugins in\r\n\r\n327b62b6103771bd19465f10a6d4f0412c2b9f1c from [2]\r\n\r\nthis hack was removed, to be restored with\r\n\r\n7f34c101d70126497afbf448c9d7ffb6faf6655a from [3]\r\n\r\nNow in addition to inspecting the function signature, an assumption is\r\nmade about the string message of the TypeError that occurs for legacy\r\nhandler functions (namely, that it start with func.__name__).\r\n\r\nIn Python 3.10, the TypeError uses func.__qualname__ [4], however, due\r\nto the patch [5]. Thus, checking whether the TypeError is due to an\r\noutdated function signature or something internal to the handler fais.\r\n\r\nAs a fix, instead of using __name__ or __qualname__ depending on Python\r\nversion, let's just revert to the old hack from [1], I'm not seeing a\r\nsignificant advantage in [3].  The latter might be a bit faster since it\r\ndoesn't construct a new dict for each call, but only for legacy calls in\r\nthe excption handler. I doubt that really matters, and if it does, we\r\nshould try to think of a better fix than inspecting error messages with\r\nno guarantees about their content in such a central place in the code.\r\n\r\n[1] https://github.com/beetbox/beets/pull/652\r\n[2] https://github.com/beetbox/beets/pull/1320\r\n[3] https://github.com/beetbox/beets/pull/1359\r\n[4] https://docs.python.org/3.10/glossary.html#term-qualified-name\r\n[5] https://bugs.python.org/issue40679\r\n```",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/3885",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/3885/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/3885/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/3885/events",
        "html_url": "https://github.com/beetbox/beets/pull/3885",
        "id": 833564485,
        "node_id": "MDExOlB1bGxSZXF1ZXN0NTk0NTQxMTIz",
        "number": 3885,
        "title": "Remove ascii encode step",
        "user": {
            "login": "nicksellen",
            "id": 31616,
            "node_id": "MDQ6VXNlcjMxNjE2",
            "avatar_url": "https://avatars.githubusercontent.com/u/31616?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/nicksellen",
            "html_url": "https://github.com/nicksellen",
            "followers_url": "https://api.github.com/users/nicksellen/followers",
            "following_url": "https://api.github.com/users/nicksellen/following{/other_user}",
            "gists_url": "https://api.github.com/users/nicksellen/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/nicksellen/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nicksellen/subscriptions",
            "organizations_url": "https://api.github.com/users/nicksellen/orgs",
            "repos_url": "https://api.github.com/users/nicksellen/repos",
            "events_url": "https://api.github.com/users/nicksellen/events{/privacy}",
            "received_events_url": "https://api.github.com/users/nicksellen/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 1,
        "created_at": "2021-03-17T09:18:06Z",
        "updated_at": "2021-03-17T11:58:49Z",
        "closed_at": "2021-03-17T11:58:49Z",
        "author_association": "CONTRIBUTOR",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/3885",
            "html_url": "https://github.com/beetbox/beets/pull/3885",
            "diff_url": "https://github.com/beetbox/beets/pull/3885.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/3885.patch"
        },
        "body": "## Description\r\n\r\nFixes https://github.com/beetbox/beets/issues/1051 (and maybe a reoccurrence of https://github.com/beetbox/beets/issues/2387)\r\n\r\nAs described in [this comment](https://github.com/beetbox/beets/issues/1051#issuecomment-800584218) I encountered a `TypeError: sequence item 0: expected str instance, bytes found` error, and it seems the step to encode to ascii is no longer required. Removing it resolved this issue for me.\r\n\r\n## To Do\r\n\r\n- [ ] ~~Documentation. (If you've add a new command-line flag, for example, find the appropriate page under `docs/` to describe it.)~~\r\n- [x] Changelog. (Add an entry to `docs/changelog.rst` near the top of the document.)\r\n- [ ] ~~Tests. (Encouraged but not strictly required.)~~\r\n",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/3812",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/3812/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/3812/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/3812/events",
        "html_url": "https://github.com/beetbox/beets/pull/3812",
        "id": 768535177,
        "node_id": "MDExOlB1bGxSZXF1ZXN0NTQwOTUzNzc2",
        "number": 3812,
        "title": "Fix escape helper in fish completion plugin",
        "user": {
            "login": "billyjanitsch",
            "id": 1158733,
            "node_id": "MDQ6VXNlcjExNTg3MzM=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1158733?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/billyjanitsch",
            "html_url": "https://github.com/billyjanitsch",
            "followers_url": "https://api.github.com/users/billyjanitsch/followers",
            "following_url": "https://api.github.com/users/billyjanitsch/following{/other_user}",
            "gists_url": "https://api.github.com/users/billyjanitsch/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/billyjanitsch/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/billyjanitsch/subscriptions",
            "organizations_url": "https://api.github.com/users/billyjanitsch/orgs",
            "repos_url": "https://api.github.com/users/billyjanitsch/repos",
            "events_url": "https://api.github.com/users/billyjanitsch/events{/privacy}",
            "received_events_url": "https://api.github.com/users/billyjanitsch/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 1,
        "created_at": "2020-12-16T07:22:12Z",
        "updated_at": "2020-12-16T20:03:58Z",
        "closed_at": "2020-12-16T13:10:48Z",
        "author_association": "CONTRIBUTOR",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/3812",
            "html_url": "https://github.com/beetbox/beets/pull/3812",
            "diff_url": "https://github.com/beetbox/beets/pull/3812.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/3812.patch"
        },
        "body": "## Description\r\n\r\nThe `_escape` helper was introduced in https://github.com/beetbox/beets/pull/3792, specifically 57a1b3aca86253d130848fdfcd2accbed861b5ee, but the omission of a `return` statement means that the function always incorrectly returns `None`. This causes `beet fish` to error when it eventually attempts to concatenate the value with a string:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/linuxbrew/.linuxbrew/bin/beet\", line 8, in <module>\r\n    sys.exit(main())\r\n  File \"/home/linuxbrew/.linuxbrew/opt/python@3.9/lib/python3.9/site-packages/beets/ui/__init__.py\", line 1278, in main\r\n    _raw_main(args)\r\n  File \"/home/linuxbrew/.linuxbrew/opt/python@3.9/lib/python3.9/site-packages/beets/ui/__init__.py\", line 1265, in _raw_main\r\n    subcommand.func(lib, suboptions, subargs)\r\n  File \"/home/linuxbrew/.linuxbrew/opt/python@3.9/lib/python3.9/site-packages/beetsplug/fish.py\", line 127, in run\r\n    totstring += get_subcommands(\r\n  File \"/home/linuxbrew/.linuxbrew/opt/python@3.9/lib/python3.9/site-packages/beetsplug/fish.py\", line 213, in get_subcommands\r\n    \"fieldsetups for  \" + cmdname) + \"\\n\"\r\nTypeError: can only concatenate str (not \"NoneType\") to str\r\n```\r\n\r\nThis PR adds the missing `return` statement.\r\n\r\nIMO a changelog entry isn't necessarily because it's such a simple fix, but let me know if you disagree.\r\n\r\n## To Do\r\n\r\n- [ ] Documentation. (If you've add a new command-line flag, for example, find the appropriate page under `docs/` to describe it.)\r\n- [ ] Changelog. (Add an entry to `docs/changelog.rst` near the top of the document.)\r\n- [ ] Tests. (Encouraged but not strictly required.)\r\n",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/3360",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/3360/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/3360/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/3360/events",
        "html_url": "https://github.com/beetbox/beets/pull/3360",
        "id": 490659876,
        "node_id": "MDExOlB1bGxSZXF1ZXN0MzE1MjExOTI5",
        "number": 3360,
        "title": "fix bug with pathlib",
        "user": {
            "login": "eljojo",
            "id": 491230,
            "node_id": "MDQ6VXNlcjQ5MTIzMA==",
            "avatar_url": "https://avatars.githubusercontent.com/u/491230?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/eljojo",
            "html_url": "https://github.com/eljojo",
            "followers_url": "https://api.github.com/users/eljojo/followers",
            "following_url": "https://api.github.com/users/eljojo/following{/other_user}",
            "gists_url": "https://api.github.com/users/eljojo/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/eljojo/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/eljojo/subscriptions",
            "organizations_url": "https://api.github.com/users/eljojo/orgs",
            "repos_url": "https://api.github.com/users/eljojo/repos",
            "events_url": "https://api.github.com/users/eljojo/events{/privacy}",
            "received_events_url": "https://api.github.com/users/eljojo/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 6,
        "created_at": "2019-09-07T17:26:45Z",
        "updated_at": "2020-07-16T02:00:51Z",
        "closed_at": "2020-07-16T02:00:50Z",
        "author_association": "CONTRIBUTOR",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/3360",
            "html_url": "https://github.com/beetbox/beets/pull/3360",
            "diff_url": "https://github.com/beetbox/beets/pull/3360.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/3360.patch"
        },
        "body": "Hi,\r\n\r\nThe `thumbnails` plugin was failing for me. The following patch fixed it.\r\n\r\n```\r\n$ python --version\r\nPython 3.5.7\r\njojo at jojo-mini in ~/code/beets (master\u25cf)\r\n$ beet thumbnails\r\nTraceback (most recent call last):\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/bin/beet\", line 11, in <module>\r\n    load_entry_point('beets==1.4.9', 'console_scripts', 'beet')()\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beets/ui/__init__.py\", line 1266, in main\r\n    _raw_main(args)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beets/ui/__init__.py\", line 1253, in _raw_main\r\n    subcommand.func(lib, suboptions, subargs)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beetsplug/thumbnails.py\", line 78, in process_query\r\n    self.process_album(album)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beetsplug/thumbnails.py\", line 133, in process_album\r\n    wrote &= self.make_cover_thumbnail(album, 128, NORMAL_DIR)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beetsplug/thumbnails.py\", line 144, in make_cover_thumbnail\r\n    target = os.path.join(target_dir, self.thumbnail_file_name(album.path))\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beetsplug/thumbnails.py\", line 165, in thumbnail_file_name\r\n    uri = self.get_uri(path)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/site-packages/beetsplug/thumbnails.py\", line 227, in uri\r\n    return PurePosixPath(path).as_uri()\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/pathlib.py\", line 622, in __new__\r\n    return cls._from_parts(args)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/pathlib.py\", line 651, in _from_parts\r\n    drv, root, parts = self._parse_args(args)\r\n  File \"/Users/jojo/.asdf/installs/python/3.5.7/lib/python3.5/pathlib.py\", line 643, in _parse_args\r\n    % type(a))\r\nTypeError: argument should be a path or str object, not <class 'bytes'>\r\n```",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/3129",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/3129/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/3129/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/3129/events",
        "html_url": "https://github.com/beetbox/beets/pull/3129",
        "id": 402532245,
        "node_id": "MDExOlB1bGxSZXF1ZXN0MjQ3MTk0Mzg2",
        "number": 3129,
        "title": "Set Spotify AlbumInfo.mediums",
        "user": {
            "login": "rhlahuja",
            "id": 5376621,
            "node_id": "MDQ6VXNlcjUzNzY2MjE=",
            "avatar_url": "https://avatars.githubusercontent.com/u/5376621?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/rhlahuja",
            "html_url": "https://github.com/rhlahuja",
            "followers_url": "https://api.github.com/users/rhlahuja/followers",
            "following_url": "https://api.github.com/users/rhlahuja/following{/other_user}",
            "gists_url": "https://api.github.com/users/rhlahuja/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/rhlahuja/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/rhlahuja/subscriptions",
            "organizations_url": "https://api.github.com/users/rhlahuja/orgs",
            "repos_url": "https://api.github.com/users/rhlahuja/repos",
            "events_url": "https://api.github.com/users/rhlahuja/events{/privacy}",
            "received_events_url": "https://api.github.com/users/rhlahuja/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 1,
        "created_at": "2019-01-24T03:57:58Z",
        "updated_at": "2019-01-24T04:19:07Z",
        "closed_at": "2019-01-24T04:19:07Z",
        "author_association": "CONTRIBUTOR",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/3129",
            "html_url": "https://github.com/beetbox/beets/pull/3129",
            "diff_url": "https://github.com/beetbox/beets/pull/3129.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/3129.patch"
        },
        "body": "Set `AlbumInfo.mediums` in the Spotify plugin's `candidates` function to address:\r\n```\r\nCorrecting tags from:\r\n    Progressive Collection, Vol. 8\r\nTo:\r\n    Progressive Collection, Vol. 8\r\nURL:\r\n    https://open.spotify.com/album/6IJPzMcrOsZfKGncwTKIKB\r\n(Similarity: 83.4%) (tracks, source) (Spotify, 2016, Forward Music)\r\nTraceback (most recent call last):\r\n  File \"/usr/local/bin/beet\", line 11, in <module>\r\n    load_entry_point('beets', 'console_scripts', 'beet')()\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/__init__.py\", line 1262, in main\r\n    _raw_main(args)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/__init__.py\", line 1249, in _raw_main\r\n    subcommand.func(lib, suboptions, subargs)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/commands.py\", line 955, in import_func\r\n    import_files(lib, paths, query)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/commands.py\", line 925, in import_files\r\n    session.run()\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/importer.py\", line 329, in run\r\n    pl.run_parallel(QUEUE_SIZE)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/util/pipeline.py\", line 445, in run_parallel\r\n    six.reraise(exc_info[0], exc_info[1], exc_info[2])\r\n  File \"/usr/local/lib/python3.7/site-packages/six.py\", line 693, in reraise\r\n    raise value\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/util/pipeline.py\", line 312, in run\r\n    out = self.coro.send(msg)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/util/pipeline.py\", line 171, in coro\r\n    task = func(*(args + (task,)))\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/importer.py\", line 1375, in user_query\r\n    task.choose_match(session)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/importer.py\", line 838, in choose_match\r\n    choice = session.choose_match(self)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/commands.py\", line 714, in choose_match\r\n    task.cur_album, itemcount=len(task.items), choices=choices\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/commands.py\", line 615, in choose_candidate\r\n    show_change(cur_artist, cur_album, match)\r\n  File \"/Users/rahulahuja/git/beetbox/beets/beets/ui/commands.py\", line 304, in show_change\r\n    if match.info.mediums > 1 and track_info.disctitle:\r\nTypeError: '>' not supported between instances of 'NoneType' and 'int'\r\n```\r\nI've also adjusted the `AlbumInfo` docstring to reflect that `mediums` is a required field, which is what that error seems to imply. Is this accurate? I probably should've caught this during testing my last PR btw :sweat_smile:. But the good news is that with this bugfix, `beet import` / Spotify Search API has been autotagging my music flawlessly!",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/2659",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/2659/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/2659/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/2659/events",
        "html_url": "https://github.com/beetbox/beets/pull/2659",
        "id": 251491110,
        "node_id": "MDExOlB1bGxSZXF1ZXN0MTM2NjQ0Njkx",
        "number": 2659,
        "title": "Fix the edit plugin displaying bogus data or even crashing on re-imports",
        "user": {
            "login": "wisp3rwind",
            "id": 17089248,
            "node_id": "MDQ6VXNlcjE3MDg5MjQ4",
            "avatar_url": "https://avatars.githubusercontent.com/u/17089248?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/wisp3rwind",
            "html_url": "https://github.com/wisp3rwind",
            "followers_url": "https://api.github.com/users/wisp3rwind/followers",
            "following_url": "https://api.github.com/users/wisp3rwind/following{/other_user}",
            "gists_url": "https://api.github.com/users/wisp3rwind/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/wisp3rwind/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/wisp3rwind/subscriptions",
            "organizations_url": "https://api.github.com/users/wisp3rwind/orgs",
            "repos_url": "https://api.github.com/users/wisp3rwind/repos",
            "events_url": "https://api.github.com/users/wisp3rwind/events{/privacy}",
            "received_events_url": "https://api.github.com/users/wisp3rwind/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 3,
        "created_at": "2017-08-20T14:15:50Z",
        "updated_at": "2017-08-21T02:04:58Z",
        "closed_at": "2017-08-20T22:36:15Z",
        "author_association": "MEMBER",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/2659",
            "html_url": "https://github.com/beetbox/beets/pull/2659",
            "diff_url": "https://github.com/beetbox/beets/pull/2659.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/2659.patch"
        },
        "body": "There seems to be a bug in the edit plugin when re-importing (`beet import -L`) items that are in the library already:\r\n\r\nAs can be seen in the diff, the plugin assigns temporary `id`s to the items to be edited (presumably for applying the changes to the correct obejct in `EditPlugin.apply_data` or because some function deeper in the guts of beets requires a non-`None` id). This doesn't really cause any problems if none of the items is in the database: `EditPlugin.edit_objects` will create a `deepcopy` for any object with a false-y `Item._db` and hand that to `beets.ui.show_model_changes`.\r\n\r\nIf however `Item._db` is set, `EditPlugin.edit_objects` will provide `None` as the old object to `beets.ui.show_model_changes` which will in turn query the database with the (invalid temporary!) `id` of the new object to obtain the previous object and show the diff. Now, since the `id` is invalid, two things can happen:\r\n\r\n- an object with that `id` actually exists: No crash will happen (and the edit finishes cleanly), but the old state for the diff will be a totally unrelated `Item`.\r\n- No such object exists: The database query will return `None`, and the following traceback happens:\r\n\r\n```\r\nTraceback (most recent call last):\r\n  File \"/home/[...]/bin/beet\", line 11, in <module>\r\n    sys.exit(main())\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/__init__.py\", line 1258, in main\r\n    _raw_main(args)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/__init__.py\", line 1245, in _raw_main\r\n    subcommand.func(lib, suboptions, subargs)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/commands.py\", line 934, in import_func\r\n    import_files(lib, paths, query)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/commands.py\", line 911, in import_files\r\n    session.run()\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/importer.py\", line 325, in run\r\n    pl.run_parallel(QUEUE_SIZE)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/util/pipeline.py\", line 445, in run_parallel\r\n    six.reraise(exc_info[0], exc_info[1], exc_info[2])\r\n  File \"/home/[...]/lib/python3.6/site-packages/six.py\", line 686, in reraise\r\n    raise value\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/util/pipeline.py\", line 312, in run\r\n    out = self.coro.send(msg)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/util/pipeline.py\", line 171, in coro\r\n    task = func(*(args + (task,)))\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/importer.py\", line 1317, in user_query\r\n    task.choose_match(session)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/importer.py\", line 889, in choose_match\r\n    choice = session.choose_item(self)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/commands.py\", line 755, in choose_item\r\n    post_choice = choice.callback(self, task)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beetsplug/edit.py\", line 376, in importer_edit\r\n    success = self.edit_objects(task.items, fields)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beetsplug/edit.py\", line 293, in edit_objects\r\n    changed |= ui.show_model_changes(obj, obj_old)\r\n  File \"/home/[...]/lib/python3.6/site-packages/beets/ui/__init__.py\", line 707, in show_model_changes\r\n    for field in old:\r\nTypeError: 'NoneType' object is not iterable\r\n\r\n```\r\n\r\nI'd appreciate if someone could check the correctness of that analysis. I assumed negative temporary `id`s to be safe (see the code) since these items are never comitted to the database (which would create a new `id` anyway). I'm not an exactly expert on the database code, though. Is that a reasonable assumption?\r\n\r\n(The actual context how I found this bug is somewhat different: I'm writing a plugin, that puts new `Item`s in the database in order to attach a few flexattrs. It then runs a `TerminalImportSession` to fill in the remaining metadata. Using the eDit option in that situation triggers the same bug.)",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/2523",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/2523/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/2523/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/2523/events",
        "html_url": "https://github.com/beetbox/beets/pull/2523",
        "id": 223526275,
        "node_id": "MDExOlB1bGxSZXF1ZXN0MTE3MDg3MTM1",
        "number": 2523,
        "title": "Rename error",
        "user": {
            "login": "discopatrick",
            "id": 254822,
            "node_id": "MDQ6VXNlcjI1NDgyMg==",
            "avatar_url": "https://avatars.githubusercontent.com/u/254822?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/discopatrick",
            "html_url": "https://github.com/discopatrick",
            "followers_url": "https://api.github.com/users/discopatrick/followers",
            "following_url": "https://api.github.com/users/discopatrick/following{/other_user}",
            "gists_url": "https://api.github.com/users/discopatrick/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/discopatrick/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/discopatrick/subscriptions",
            "organizations_url": "https://api.github.com/users/discopatrick/orgs",
            "repos_url": "https://api.github.com/users/discopatrick/repos",
            "events_url": "https://api.github.com/users/discopatrick/events{/privacy}",
            "received_events_url": "https://api.github.com/users/discopatrick/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 6,
        "created_at": "2017-04-22T00:14:59Z",
        "updated_at": "2017-05-01T19:29:22Z",
        "closed_at": "2017-05-01T19:29:22Z",
        "author_association": "MEMBER",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/2523",
            "html_url": "https://github.com/beetbox/beets/pull/2523",
            "diff_url": "https://github.com/beetbox/beets/pull/2523.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/2523.patch"
        },
        "body": "As discussed at https://github.com/beetbox/beets/pull/2517#issuecomment-294300430, the way we use `InvalidQueryArgumentTypeError` is more akin to a `ValueError` than a `TypeError`. For example, we try to parse a string as an int, float, or date, but the parsing fails - there was nothing wrong with the Type of the variable (string), but its contents were not parseable into the type we wanted - there was a problem with the value of the string.\r\n\r\nThus `InvalidQueryArgumentTypeError` is renamed to `InvalidQueryArgumentValueError` in this pull request.",
        "performed_via_github_app": null,
        "score": 1.0
    },
    {
        "url": "https://api.github.com/repos/beetbox/beets/issues/2353",
        "repository_url": "https://api.github.com/repos/beetbox/beets",
        "labels_url": "https://api.github.com/repos/beetbox/beets/issues/2353/labels{/name}",
        "comments_url": "https://api.github.com/repos/beetbox/beets/issues/2353/comments",
        "events_url": "https://api.github.com/repos/beetbox/beets/issues/2353/events",
        "html_url": "https://github.com/beetbox/beets/pull/2353",
        "id": 197983627,
        "node_id": "MDExOlB1bGxSZXF1ZXN0OTk2Mzg1MTA=",
        "number": 2353,
        "title": "Web attachment filenames must be passed as a string for Python 3",
        "user": {
            "login": "dopefishh",
            "id": 1789556,
            "node_id": "MDQ6VXNlcjE3ODk1NTY=",
            "avatar_url": "https://avatars.githubusercontent.com/u/1789556?v=4",
            "gravatar_id": "",
            "url": "https://api.github.com/users/dopefishh",
            "html_url": "https://github.com/dopefishh",
            "followers_url": "https://api.github.com/users/dopefishh/followers",
            "following_url": "https://api.github.com/users/dopefishh/following{/other_user}",
            "gists_url": "https://api.github.com/users/dopefishh/gists{/gist_id}",
            "starred_url": "https://api.github.com/users/dopefishh/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/dopefishh/subscriptions",
            "organizations_url": "https://api.github.com/users/dopefishh/orgs",
            "repos_url": "https://api.github.com/users/dopefishh/repos",
            "events_url": "https://api.github.com/users/dopefishh/events{/privacy}",
            "received_events_url": "https://api.github.com/users/dopefishh/received_events",
            "type": "User",
            "site_admin": false
        },
        "labels": [],
        "state": "closed",
        "locked": false,
        "assignee": null,
        "assignees": [],
        "milestone": null,
        "comments": 2,
        "created_at": "2016-12-29T10:12:04Z",
        "updated_at": "2016-12-29T18:33:03Z",
        "closed_at": "2016-12-29T10:38:28Z",
        "author_association": "CONTRIBUTOR",
        "active_lock_reason": null,
        "draft": false,
        "pull_request": {
            "url": "https://api.github.com/repos/beetbox/beets/pulls/2353",
            "html_url": "https://github.com/beetbox/beets/pull/2353",
            "diff_url": "https://github.com/beetbox/beets/pull/2353.diff",
            "patch_url": "https://github.com/beetbox/beets/pull/2353.patch"
        },
        "body": "This PR fixes the following bug in the web interface\r\n\r\nWhen downloading a file the the following error occurs:\r\n```\r\n[2016-12-29 11:11:07,039] ERROR in app: Exception on /item/10652/file [GET]\r\nTraceback (most recent call last):\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/app.py\", line 1982, in wsgi_app\r\n    response = self.full_dispatch_request()\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/app.py\", line 1614, in full_dispatch_request\r\n    rv = self.handle_user_exception(e)\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/app.py\", line 1517, in handle_user_exception\r\n    reraise(exc_type, exc_value, tb)\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/_compat.py\", line 33, in reraise\r\n    raise value\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/app.py\", line 1612, in full_dispatch_request\r\n    rv = self.dispatch_request()\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/app.py\", line 1598, in dispatch_request\r\n    return self.view_functions[rule.endpoint](**req.view_args)\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/beets-1.4.3-py3.5.egg/beetsplug/web/__init__.py\", line 209, in item_file\r\n    attachment_filename=os.path.basename(item.path),\r\n  File \"/home/mrl/projects/beets/lib/python3.5/site-packages/flask/helpers.py\", line 522, in send_file\r\n    mimetype = mimetypes.guess_type(attachment_filename)[0] \\\r\n  File \"/usr/lib/python3.5/mimetypes.py\", line 289, in guess_type\r\n    return _db.guess_type(url, strict)\r\n  File \"/usr/lib/python3.5/mimetypes.py\", line 114, in guess_type\r\n    scheme, url = urllib.parse.splittype(url)\r\n  File \"/usr/lib/python3.5/urllib/parse.py\", line 862, in splittype\r\n    match = _typeprog.match(url)\r\nTypeError: cannot use a string pattern on a bytes-like object\r\n```",
        "performed_via_github_app": null,
        "score": 1.0
    }
]